# 角色管理

## 清除表单上次校验

```ts
// 创建按钮回调
const handleCreate = () => {
    dialogVisible.value = true
    formRef.value?.resetFields()
    roleInfo.value.name = ''
    roleInfo.value.remark = ''
    roleInfo.value.id = ''
    // 重置选中状态
    setCurrent()
}
```

## 使用inport引入图片

```ts
import deviceIcon from '@/assets/deviceicon.png';

const labelOptions = ref({
  visible: true,
  markerList: props.dataList,
  icon: {
    image: deviceIcon, // 引用已解析的图片路径
    // anchor: 'bottom-center',
    // size: [25, 34],
    // clipOrigin: [459, 92],
    // clipSize: [50, 68]
  }
});

```

## 遍历获取需要属性

```ts
// 处理数据-获取根节点数据
const filterMenuData = (original: any[]) => {
    return original
        .filter((item: any) => !item.pid) // 筛选 pid 为空的根节点
        .map((item: any) => ({
            id: item.id,
            name: item.name,
            pid: item.pid,
        })); // 返回只包含 id、name、pid 的对象数组
};

// 示例数据
const originalData = [
    { id: 1, name: "根节点1", pid: null },
    { id: 2, name: "子节点1", pid: 1 },
    { id: 3, name: "根节点2", pid: null },
    { id: 4, name: "子节点2", pid: 3 },
];

// 调用函数
const rootNodes = filterMenuData(originalData);
console.log(rootNodes);
```

## 复制按钮动态显示

```vue
<template>
  <div class="copy-container">
    <!-- 提示框 -->
    <el-tooltip
      content="点击复制"
      placement="top"
      v-if="!copied"
    >
      <!-- 未复制图标 -->
      <el-icon
        :class="['copy-icon', copied ? 'copied' : '']"
        @click="handleCopy"
      >
        <copy-document />
      </el-icon>
    </el-tooltip>

    <!-- 已复制的提示 -->
    <el-tooltip
      content="已复制！"
      placement="top"
      v-if="copied"
    >
      <el-icon
        :class="['copy-icon', copied ? 'copied' : '']"
      >
        <check />
      </el-icon>
    </el-tooltip>
  </div>
</template>

<script lang="ts">
import { ref } from "vue";
import { ElMessage } from "element-plus";
import { CopyDocument, Check } from "@element-plus/icons-vue";

export default {
  components: {
    CopyDocument,
    Check,
  },
  setup() {
    // 是否已复制的状态
    const copied = ref(false);

    // 处理复制逻辑
    const handleCopy = () => {
      // 模拟复制功能，可以替换为实际逻辑
      const textToCopy = "要复制的内容";
      navigator.clipboard.writeText(textToCopy).then(
        () => {
          copied.value = true;
          ElMessage.success("复制成功！");

          // 2秒后恢复为未复制状态
          setTimeout(() => {
            copied.value = false;
          }, 2000);
        },
        () => {
          ElMessage.error("复制失败，请重试！");
        }
      );
    };

    return {
      copied,
      handleCopy,
    };
  },
};
</script>

<style scoped>
.copy-container {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.copy-icon {
  font-size: 24px;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.copy-icon.copied {
  color: green;
  transform: scale(1.2);
}
</style>

```

```ts
功能解析
图标动态切换

使用 copied 状态管理图标的显示。
根据状态，切换显示为未复制或已复制的图标。
复制功能

使用 navigator.clipboard.writeText 将文本写入剪贴板。
成功后，通过 copied 状态触发图标变化。
延迟恢复状态

使用 setTimeout 在 2 秒后将 copied 状态重置为 false。
样式动画

使用 CSS 的 transform 和 transition 增加用户交互的视觉效果。
提示信息

使用 ElMessage 显示操作反馈。
运行效果
点击图标时，文本被复制，图标变为已复制的状态，并且显示提示信息。
2 秒后，图标恢复为未复制状态，可以再次点击复制。
```

## 三元运算符

```ts
简化写法
如果状态较少且逻辑简单，可以直接在模板中通过三元表达式实现：

<span>
    {{ item.off === 0 ? item.property1 : item.off === 1 ? item.property2 : item.property3 }}
</span>
```

### null的判断

```ts
在你的代码中，item.off >= 0 表达式会导致 null 被隐式转换为 0，因为在 JavaScript 中，比较运算符 >= 会将 null 转换为数字 0，因此 null >= 0 的结果是 true

在 JavaScript 中，>= 会触发隐式类型转换：

如果 item.off 是 null，它会被转换为数字 0。
然后 0 >= 0 评估为 true，所以颜色被设置为绿色。

<span :style="{ color: item.off === null || item.off === undefined ? 'red' : item.off >= 0 ? 'green' : 'red', marginLeft: '1px' }">
    {{ item.off }}
</span>

```

## 加载中骨架屏 栅格

`<el-card>` 之所以会纵向排列，是因为它们默认是以 **块级元素（block-level element）** 的方式排列的，也就是每个卡片占据一整行。为了让它们横向排列，需要使用 **Flex 布局** 或 **Grid 布局** 来控制其排列方式。

Element Plus 提供的栅格系统可以方便地实现横向排列。

```vue
<el-skeleton class="skeleton-loading" v-show="deviceListLoading" animated style="width: 100%;">
    <template #template>
        <el-row :gutter="10">
            <el-col :span="6" v-for="(_, index) in 12" :key="index">
                <el-card style="border-radius: 5px;">Card {{ index + 1 }}</el-card>
            </el-col>
        </el-row>
    </template>
</el-skeleton>

```

