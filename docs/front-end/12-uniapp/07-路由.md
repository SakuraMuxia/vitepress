# 路由

## 路由跳转

```ts
页面的跳转方式有两种
	编程式导航	类似于 router.push(...)
    声明式导航 	类似于 <router-link :to="...">
```

案例

```ts
# 新建一个文件夹detail,用于存放详情的页面
# 设置页面的标题

```

## 声明式导航

```ts
navigitor组件
属性
    # url			当前小程序内的跳转链接		string
    # open-type	跳转方式				 string 默认跳转方式 navigate	
        # navigate	保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面(对应 wx.navigateTo)
        # redirect	关闭当前页面，跳转到应用内的某个页面。但是不允许跳转到 tabbar 页面(对应 wx.redirectTo 的功能)
```

```xml
<navigitor url="" open-type="navigate" ></navigitor>
```



## 编程式导航

### wx.navigateTo()

### wx.redirectTo()

```ts
wx.navigateTo(Object object)
wx.redirectTo(Object object)
```

```ts
wx.navigateTo(Object object)
对象中属性:
	url		string	需要跳转的应用内非 tabBar 的页面的路径,路径后可以带参数,如 'path?key=value&key2=value2'
	events	object 	页面间通信接口，用于监听被打开页面发送到当前页面的数据
    success	function	接口调用成功的回调函数
	fail	function	接口调用失败的回调函数
	complete function	接口调用结束的回调函数（调用成功、失败都会执行）
```

**使用案例**

```ts
//通过Page方法创建页面   App->Page
Page({
    //页面数据
    data: {
        name: '结城sakuna',
        deg:0,
    },
    //编程式导航按钮回调
    goDetail(){
        //编程式导航页面跳转
        //navigateTo:A->B，但是A页面不会销毁(不能跳转到tabbar页面)
        //redirectTo 关闭当前页面，跳转到应用内的某个页面。但是不允许跳转到 tabbar 页面。
        wx.redirectTo({
          url: '/pages/detail/detail?a=1&b=2',
        })
    },
})
```

```ts
<view class="home">
    <view class="title">首页</view>
    <view>{{name}}</view>
    <image src="https://2216847528.oss-cn-beijing.aliyuncs.com/asset/20241118104045.png" 
        style="transform:rotate({{deg}}deg)"
        class="avatar"
    />
    <view>声明式导航</view>
    <navigator url="/pages/detail/detail">
        <text class="iconfont icon-baomirenyuan" style="font-size: 80rpx;"></text>
    </navigator>
    <view>编程式导航</view>
    <button type="primary" size="mini" bind:tap="goDetail">
        <text class="iconfont icon-baomirenyuan"></text>
    </button>
</view>
```

```css
.home{
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.home .title{
    width: 750rpx;
    height: 200rpx;
    background-color: aquamarine;
    text-align: center;
    line-height: 200rpx;
}
.home .avatar{
    width: 200rpx;
    height: 200rpx;
    border-radius: 50%;
    margin: 20rpx 0rpx;
}
```

```xml
<!--pages/detail/detail.wxml-->
<text>pages/detail/detail.wxml</text>
```

### wx.navigateBack()

关闭当前页面，返回上一页面或多级页面。可通过 getCurrentPages 获取当前的页面栈，决定需要返回几层

| 属性     | 类型     | 默认值 | 必填 | 说明                                                  |
| :------- | :------- | :----- | :--- | :---------------------------------------------------- |
| delta    | number   | 1      | 否   | 返回的页面数，如果 delta 大于现有页面数，则返回到首页 |
| success  | function |        | 否   | 接口调用成功的回调函数                                |
| fail     | function |        | 否   | 接口调用失败的回调函数                                |
| complete | function |        | 否   | 接口调用结束的回调函数（调用成功、失败都会执行）      |

```ts

// 注意：调用 navigateTo 跳转时，调用该方法的页面会被加入堆栈，而 redirectTo 方法则不会。见下方示例代码

// 此处是A页面
wx.navigateTo({
  url: 'B?id=1'
})

// 此处是B页面
wx.navigateTo({
  url: 'C?id=1'
})

// 在C页面内 navigateBack，将返回A页面
wx.navigateBack({
  delta: 2
})
```

**使用案例**

```js
// pages/edit/edit.js
import { reqUserInfo,reqUpdateInfo } from '../../api/index'
Page({

    /**
     * 页面的初始数据
     */
    data: {
        //用户昵称
        nickname: '',
        //  头像
        headimgurl: '',
    },

    /**
     * 生命周期函数--监听页面加载
     */
    onLoad(options) {
        //获取用户信息
        this.getUserInfo();
    },
    //获取用户信息(请求头携带token)
    async getUserInfo() {
        const result = await reqUserInfo();
        if (result.code == 200) {
            this.setData({
                nickname: result.data.nickname,
                headimgurl: result.data.headimgurl
            })
        }
    },
    //获取用户头像的回调
    chooseAvatar(event) {
        this.setData({
            headimgurl: event.detail.avatarUrl
        })
    },

    //更新信息按钮的回调
    async updateUser() {
        //用户信息更新成功,回到tabbar个人中心页面
        //navigateTo|redirectTo
        // 发送请求
        const result = await reqUpdateInfo(this.data);
        if (result.code == 200) {
            //返回个人中心[login登录页销毁了!!!]
            wx.navigateBack();
        }
    },
})
```

