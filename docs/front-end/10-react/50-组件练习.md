# 开发思路

```jsx
:new: 组件化的开发思路：

6-1. 静态布局：组件拆分

6-2. 首屏数据渲染：

- 数据结构分析：
- 分析数据定义在谁身上

6-3. 用户交互功能实现

1. 描述：干了什么-》什么结果
2. 拆分步骤：
3. 给步骤匹配技术点
```

# 导包规范

```shell
把第三方的包放在自定义的上边
```



# 轮播图练习

:new: 主页面文件：src->App.js

```jsx
import React, { Component } from 'react'
import Child from './components/Class/Child'

export default class App extends Component {
    render() {
        return (
            <div>
                <h3>App</h3>
                <hr />
                <Child></Child>
            </div>
        )
    }
}
```

导入图片：src->assets->images

```jsx
1.jpeg
2.jpeg
3.jpeg
```

子组件：src->components->Class->Child.jsx

```jsx
import React, { Component } from 'react'
// 导入样式
import './Child.css'
export default class Child extends Component {
    // 定义数据状态
    state = {
        imgArr: ['1.jpeg', '2.jpeg', '3.jpeg'],
        index: 0
    }
    // 定义方法
    changePicAdd(index,imgArr){
        index++;
        if (index > imgArr.length -1) {
            index = 0;
        }
        this.setState({
            index
        })
    }
    changePicSub(index, imgArr){
        index--;
        if (index < 0) {
            index = imgArr.length - 1;
        }
        this.setState({
            index
        })
    }
    render() {
        let { index,imgArr } = this.state;
        return (
            <>
                <div className='wrapper'>
                    <img src={require(`../../assets/images/${imgArr[index]}`)} alt="" />
                    <span className="" onClick={() => { this.changePicSub(index,imgArr) }}>&lt;</span>
                    <span className="rightBtn" onClick={this.changePicAdd.bind(this,index,imgArr)}>&gt;</span>
                </div>
            </>
        )
    }
}
```

子组件样式：src->components->Class->Child.css

```css
.wrapper {
    position: relative;
    width: 600px;
    height: 350px;
    border: 1px solid aqua;
    margin: 50px auto;
}

.wrapper img {
    width: 100%;
    height: 100%;

}

.wrapper span {
    position: absolute;
    top: 145px;
    display: block;
    width: 30px;
    height: 60px;
    background-color: #ccc;
    line-height: 60px;
    text-align: center;
    cursor: pointer;
    user-select: none;
}

.rightBtn {
    right: 0;
}
```



# 提交规范

```jsx
用于说明git commit的类别，只允许使用下面的标识。

feat：新功能（feature）。
fix/to：修复bug，可以是QA发现的BUG，也可以是研发自己发现的BUG。
fix：产生diff并自动修复此问题。适合于一次提交直接修复问题
to：只产生diff不自动修复此问题。适合于多次提交。最终修复问题提交时使用fix
docs：文档（documentation）。
update:
style：格式（不影响代码运行的变动）。
refactor：重构（即不是新增功能，也不是修改bug的代码变动）。
perf：优化相关，比如提升性能、体验。
test：增加测试。
build: 构建依赖更改
ci: 更改 CI 配置文件或者脚本
chore：更改构建流程、或者增加依赖库、工具等
revert：回滚到上一个版本。
merge：代码合并。
sync：同步主线或分支的Bug。


feat: 新功能、新特性（feature）
add: 新增功能
fix: 修改 bug  // fix：适合于一次提交直接修复问题 to：适合于多次提交。最终修复问题提交时使用fix
docs: 文档修改
merge: 代码合并
deps: 升级依赖

style: 代码格式修改, 注意不是 css 修改（修改代码格式，例如分号修改）
test: 测试用例新增、修改
revert: 恢复上一次提交、回滚到上一个版本  撤销修改
release: 发布新版本

workflow: 工作流相关文件修改
ci: 持续集成相关文件修改
build: 影响项目构建或依赖项修改
perf: 更改代码，以提高性能（在不影响代码内部行为的前提下，对程序性能进行优化）
refactor: 代码重构（重构，在不影响代码内部行为、功能下的代码修改）
chore: 修改工具相关（不在上述类型中的修改，改变构建流程、或者增加依赖库、工具等）
types：  类型定义文件更改
wip： 开发中


release描述
【新增】支持usbip映射功能
【下架】下架vpro设备睡眠功能
【优化】锁定客户端升级为需强制登录，并支持更多解锁方式
```

表情库大全

```shell
https://gitmoji.dev/
```

常用表情

```js
图标	emoji 代码	commit 说明
🎨  (调色板)	:art:	改进代码结构/代码格式
⚡ (闪电) :zap: 提升性能
🐎 (赛马)	:racehorse:	提升性能
🔥 (火焰)	:fire:	移除代码或文件
🐛(bug)	:bug:	修复 bug
🚑 (急救车)	:ambulance:	重要补丁
✨ (火花)	:sparkles:	引入新功能
📝 (备忘录)	:memo:	撰写文档
🚀 (火箭)	:rocket:	部署功能
💄 (口红)	:lipstick:	更新 UI 和样式文件
🎉 (庆祝)	:tada:	初次提交
✅ (白色复选框)	:white_check_mark:	增加测试
🔒 (锁)	:lock:	修复安全问题
🍎 (苹果)	:apple:	修复 macOS 下的内容
🐧 (企鹅)	:penguin:	修复 Linux 下的内容
🏁 (旗帜)	:checked_flag:	修复 Windows 下的内容
🤖 (Android机器人)	:robot:	修复Android上的某些内容。
🍏 (绿苹果)	:green_apple:	解决iOS上的某些问题。
🔖 (书签)	:bookmark:	发行/版本标签
🚨(警车灯)	:rotating_light:	移除 linter 警告
🚧 (施工)	:construction:	工作进行中
💚 (绿心)	:green_heart:	修复 CI 构建问题
⬇️ (下降箭头)	:arrow_down:	降级依赖
⬆️ (上升箭头)	:arrow_up:	升级依赖
📌 (图钉)	:pushpin:	将依赖关系固定到特定版本。
👷 (工人)	:construction_worker:	添加 CI 构建系统
📈 (上升趋势图)	:chart_with_upwards_trend:	添加分析或跟踪代码
♻️ (循环箭头)	:recycle:	重构代码。
🔨 (锤子)	:hammer:	重大重构
➖ (减号)	:heavy_minus_sign:	减少一个依赖
🐳 (鲸鱼)	:whale:	Docker 相关工作
➕ (加号)	:heavy_plus_sign:	增加一个依赖
🔧 (扳手)	:wrench:	修改配置文件
🌐 (地球)	:globe_with_meridians:	国际化与本地化
✏️ (铅笔)	:pencil2:	修复 typo
💩 (瞪眼)	:hankey:	编写需要改进的错误代码。
⏪ (双左箭头)	:rewind:	恢复更改。
🔀 (双合并箭头)	:twisted_rightwards_arrows:	合并分支。
📦 (箱子)	:package:	更新编译的文件或包。
👽 (面具)	:alien:	由于外部API更改而更新代码。
🚚 (面包车)	:truck:	移动或重命名文件。
📄 (文档)	:page_facing_up:	添加或更新许可证。
💥 (爆炸)	:boom:	介绍突破性变化。
🍱 (装满餐盘)	:bento:	添加或更新资产。
👌 (OK手势)	:ok_hand:	由于代码审查更改而更新代码。
♿ (坐姿)	:wheelchair:	提高可访问性。
💡 (灯泡)	:bulb:	记录源代码。
🍻 (干杯)	:beers:	醉生梦死的写代码。
💬 (提示栏)	:speech_balloon:	更新文字和文字。
🗃 (卡片盒子)	:card_file_box:	执行与数据库相关的更改。
🔊 (有声喇叭)	:loud_sound:	添加日志。
🔇 (静音喇叭)	:mute:	删除日志。
👥 (两个人头)	:busts_in_silhouette:	添加贡献者。
🚸 (小盆友)	:children_crossing:	改善用户体验/可用性。
🏗 (吊车)	:building_construction:	进行架构更改。
📱 (手机)	:iphone:	致力于响应式设计。
🤡 (小丑)	:clown_face:	嘲笑事物。
🥚 (彩蛋)	:egg:	添加一个复活节彩蛋。
🙈 (蒙眼猴子)	:see_no_evil:	添加或更新.gitignore文件。
📸 (照相机)	:camera_flash:	添加或更新快照。

```

```js
/*
emoji	emoji 代码	commit 说明

feat	✨ :new:	引入新功能
fix	    🐛	:bug:   修复 bug
style	💄	:lipstick: 更新 UI 样式文按键
format	🥚	:art: 格式化代码
docs	📝	:memo:/:book: 添加/更新文档
perf	👌	:zap:/:racehorse: 提高性能/优化
init	🎉	:tada: 初次提交/初始化项目
test	✅	:white_check_mark: 增加测试代码
refactor 🎨	:art: 改进代码结构/代码格式
patch	🚑	:ambulance: 添加重要补丁
file	📦:package:	添加package文件 (更新编译的文件或包)
publish	🚀:rocket:	发布新版本
tag	📌	:pushpin: 将依赖关系固定到特定版本
ci 👷  :construction_worker: 添加 CI 构建系统 /  :green_heart:修复 CI 构建问题 
config	🔧	:wrench: 修改配置文件
git	🙈 :see_no_evil:	添加或修改.gitignore 文件
chore	⚡ :zap: 	🐎:racehorse:  改变构建流程、或者增加依赖库、工具等
delete	🔥	:fire: 移除代码或文件
*/
```

```js
git commit 提交规范
Conventional Commits 是由众多开源项目贡献者共同约定的一个规范，用来约定 Git Commit 内容的书写方式，让 commit 内容更有价值、条理，使提交历史明确可追溯。

格式如下：

<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>

提交消息的任何一行都不能超过100个字符！这使得消息更容易在github以及各种git工具上阅读。
提交消息由页眉、正文和页脚组成，由空行分隔。

提交消息头(commit message header)
Header部分只有一行，包括三个字段：type（必需）、scope（可选）和subject（必需）。

scope
再是scope，选填，用于阐明本次commit 影响的范围，如与数据预处理相关、某模块功能相关等

body
选填，详细描述本次的commit，一般小的修改在上面description即可描述清楚，而重大更新尽量把body写的详尽，可分行

footer
一般只涉及BREAKING CHANGE和ISSUE相关
BREAKING CHANGE：比如涉及重大变更则本部分为必填项，类似版本升级、接口变更等
ISSUE相关：如当前 commit 针对某个issue，可进行引用/关闭


```

```shell
例子

# 带有description和 breaking change footer的commit
feat: allow provided config object to extend other configs

BREAKING CHANGE: `extends` key in config file is now used for extending other config files

# 使用!提交消息以引起对重大更改的注意
feat!: send an email to the customer when a product is shipped

# 提交带有范围和!的消息
feat(api)!: send an email to the customer when a product is shipped

# 提交带有!和BREAKING CHANGE footer的消息
chore!: drop support for Node 6

BREAKING CHANGE: use JavaScript features not available in Node 6.

# 提交没有正文的消息
docs: correct spelling of CHANGELOG

# 提交具有多段落body和多个footer的消息
fix: prevent racing of requests

Introduce a request id and a reference to latest request. Dismiss
incoming responses other than from latest request.

Remove timeouts which were used to mitigate the racing issue but are
obsolete now.

Reviewed-by: Z
Refs: #123
```

```js
:emoji1: :emoji2: 不超过 50 个字的摘要，首字母大写，使用祈使语气，句末不要加句号
提交信息主体引用相关 issue 或 PR 编号 <#110>
    
git commit -m ":tada: Initialize Repo"

subject 是 commit 目的的简短描述，不超过 50/80 个字符，一般 git 提交的时候会有颜色提示。

若英文用不惯，那么推荐使用中文
若是开源代码，一律推荐统一英文，英文不行可以翻译软件用起来
若是开源代码，可以再附加对应的 issue 地址
结尾不加标点符号
```

模版

```shell
# headr: <type>(<scope>): <subject>
# - type: feat, fix, docs, style, refactor, test, chore
# - scope: can be empty
# - subject: start with verb (such as 'change'), 50-character line
#
# body: 72-character wrapped. This should answer:
# * Why was this change necessary?
# * How does it address the problem?
# * Are there any side effects?
#
# footer:
# - Include a link to the issue.
# - BREAKING CHANGE
#
```

规范示例：

```
Subject

Subject 是 commit 消息的第一行，应该是一个简短的描述，不超过50个字符。它应该清楚地表明变更的目的或意图，并且使用了明确的语言。常用的动词包括：
Add：新增功能或文件
Fix：修复 bug
Change：更改已有代码
Refactor：重构代码，即不修改功能的改变
Remove：删除文件或功能
Document：修改文档
Style：修改不影响代码运行的样式，如空格、缩进等
Test：增加或修改测试

Body

Body 部分是对 commit 内容的详细描述，它应该解释代码变更的动机，并且提供与 commit 目的相关的背景信息。Body 应该包含修改的动机，与其他相关的修改如何交互，以及是如何实现的。
```

下面是一个遵循上述原则的 commit message 示例：

```jsx

Fix: 修复登录失败时未清除token的问题

在用户登录失败时，token可能被错误地清除。这个问题在某些特定条件下才会出现，并且可能导致用户登录状态丢失。

修复方法：只有在登录成功后才清除token。

Closes #123
```

chatGpt

```shell
Git commit 规范通常分为标题、正文和尾部。以下是完整的写法：

1. 标题
格式：<类型>(<范围>): <主题>
类型：常见的有 feat（功能）、fix（修复）、docs（文档）、style（格式）、refactor（重构）、test（测试）、chore（杂项）。
范围：可选，用于描述代码的影响范围。
主题：简洁明了的描述，首字母小写，不超过 50 字符。
2. 正文
内容：详细说明更改的背景和原因，推荐使用主动语态。
格式：每行不超过 72 字符，可以分段。
3. 尾部
内容：可选，用于关联相关的 issue、bug 或其他备注，格式如 Fixes #issue_number。
```

示例

```jsx
feat(auth): 添加用户登录功能

实现了用户认证的后端逻辑，增加了登录页面和表单验证。
- 用户可以通过电子邮件和密码登录
- 增加了错误处理和验证逻辑
- 更新了相关的 API 文档

Fixes #123
```



# Css样式处理

```jsx
第三方的css样式库： bootstrap.css

- 方式一：
  位置：public/css/bootstrap.css
  引入方式：public/index.html 通过 link标签引入
  <link rel="stylesheet" herf="%PUBLIC_URL%/css/bootstrap.css">或
	<!-- /前边没有./  /标识一个绝对目录，表示的是网站的根目录-->
  <link rel="stylesheet" herf="/css/bootstrap.css">
      
      
- 方式二：
  1. 安装样式库： `npm i bootstrap@3`
  2. 在入口文件 src->index.js 使用import 语法导入样式：
  import 'bootstrap/dist/css/bootstrap.min.css'
```

```jsx
重置样式：
位置：src/index.css
引入：在入口文件 src/index.js 通过 import 导入
```

```jsx
全局通用样式:
位置：src/App.css
引入：在主App页面中 src/App.jsx 通过 import 导入
```

```jsx
组件内样式:
位置：组件目录的css文件中
导入：组件中使用import 导入
```

## BootStrap警告

再导入bootstrap.css后会在控制台提示bootstrap.map这个警告,可以在bootstrap.css文件的末尾删除最后一行注释即可。

# Css模块化

```shell
css模块化：将css文件变为 js模块进行处理

作用：在样式后使用一个随机的数字后缀,解决组件同类名的样式冲突问题,原生Css默认后边导入的样式会覆盖前边导入的。
步骤：

#1. css文件名：必须以 文件名.module.css 后缀结尾
#2. 使用import 语法导入css模块并存储成 js变量

例如：
import styles from './index.module.css'
console.log('styles: ', styles); // {box: 'B_box__-Qmig'}
#3. 使用插值表达式给className赋值，之为 styles中的类名

import React, { Component } from 'react'
// 2 导入css模块并存储成js变量
import styles from './index.module.css'
console.log('styles: ', styles); // styles被处理成了一个对象
export default class B extends Component {
    render() {
        return (
            <>
            	<div className={styles.box}>B</div>
            	<div className={[styles.box, styles.app, 'container'].join(' ')}>B多个类名</div>
            </>
        )
    }
}
```

# 图片处理

```jsx
1. 网络图片：
直接填入网络地址即可

2. 本地图片: 
前提：存放位置必须在src目录中
2-1. 使用 import 导入
import imgSrc from './assets/images/1.jpeg'
<img src={imgSrc} alt="" />
2-2. 使用 require 导入
// 定义数据状态
state = {
    index:2
}
// 使用模版字符串把对应位置替换为变量
<img src={require(`./assets/images/${index}.jpeg`)} alt="" />

```

> import 导入和 require导入图片的差别：
>
> require导入可以看到图片的路径，可以通过状态数据控制导入的图片目录
>
> import导入的图片路径是写死的，不能控制

# 关闭eslint语法检查

关闭eslint语法检查，在package.js中配置

```js
...
"eslintConfig": {
        "extends": [
            "react-app",
            "react-app/jest"
        ],
        "rules": {
            "xxx":0
        }
    },
...
```

然后重启项目

# TodoList 类组件

## 静态页面拆分

```jsx
1. 创建components目录
2. 创建 TodoList、Header、Main、Item、Footer目录
3. 创建组件[jsx]及css文件
4. 在各个组件中导入 css样式 import './index.css'
5. 将todolist静态页面的整体结构拷贝到 TodoList/Todolist.jsx的结构中
6. 将样式拷贝到 TodoList/index.css中
7. 将TodoList.jsx中的 class ===> className
8. 将TodoList.jsx中的 结构 拆分到各个组件中
9. 将TodoList/index.css 的样式，拆分到各个组件中
```

## 数据结构分析

```jsx
let todos = [
    {
        id:xxx,
        title:'吃饭',
        isDone:true | false
    }
]
```

分析数据应该定义在哪个组件身上

```shell
原则：
1. 如果数据只在一个组件身上使用，那么就当以在该组件自己身上
2. 如果数据在多个组件都需要使用，那么定义在他们共同的父级身上[也叫做状态提升]
```

## 实现思路

```jsx
实现用户交互功能

思路生成步骤：描述你要做什么，产生了什么结果

1. 文本框输入内容，按下回车，将内容添加到列表中
2. 拆分步骤:
	2.1 获取文本框输入内容
    2.2 按下回车
    2.3 将内容添加到列表中
3. 给步骤匹配你能想到的技术点
	3.1 获取文本框输入内容
    	ref
        受控组件
        e.target.value
    3.2 按下回车
    	绑定事件-键盘事件 keyup keydown  onKeyUp  onKeyDown
    3.3 将内容添加到列表中
    	子传父
```

## 首屏渲染

```shell
-- 使用nanoid包生成一个不重复的id
# 安装
npm i nanoid
# 导入
import {nanoid} from 'nanoid'
# 调用
nanoid()

-- 使用random方法生成一个不重复的id 36=10位数字加26位字母
Math.random().toString(36).slice(2)
```

```js
首屏数据渲染实现步骤及技术点
1. 将todos 数据定义成 TodoList 组件的状态
2. 将 todos数据 通过标签属性的方式传递给 Main组件和 Footer组件
3. 在Main组件中接收todos，并使用map进行列表渲染，定义key值，并将遍历的每一项 todo传递给 Item组件
4. 在Footer组件中接收todos，计算total 和 doneNum后进行渲染
```

src->components->TodoList->TodoList.jsx

```shell
1. 将todos 数据定义成 TodoList 组件的状态
2. 将 todos数据 通过标签属性的方式传递给 Main组件和 Footer组件
```

```jsx
import React, { Component } from 'react'
import {nanoid} from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default class TodoList extends Component {
    state={
        todos:[
            {
                id:nanoid(),
                title:'吸烟',
                isDone:true
            },
            {
                id: nanoid(),
                title: '喝酒',
                isDone: true
            },
            {
                id: nanoid(),
                title: '烫头',
                isDone: false
            }
        ]
    }
    render() {
        let { todos } = this.state
        return (
            <>
                <div className="todo-container">
                    <div className="todo-wrap">
                        <Header />
                        <Main todos={todos}/>
                        <Footer todos={todos} />
                    </div>
                </div>
            </>
        )
    }
}
```

src->components->Main->Main.jsx

```jsx
在Main组件中接收todos，并使用map进行列表渲染，定义key值，并将遍历的每一项 todo传递给 Item组件
import React, { Component } from 'react'
import Item from '../Item/Item'
import './index.css'
export default class Main extends Component {
    render() {
        let {todos} = this.props
        return (
            <ul className="todo-main">
                {todos.map(todo => (<Item key={todo.id} todo={todo} />))}
            </ul>
        )
    }
}
```

src->components->Item->Item.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Item extends Component {
    render() {
        let {todo} = this.props
        return (
            <li>
                <label>
                    <input type="checkbox" checked={todo.isDone} />
                    <span>{todo.title}</span>
                </label>
                <button className="btn btn-danger">删除</button>
            </li>
        )
    }
}
```

src->components->Footer->Footer.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Footer extends Component {
    render(){
        // 接收todos
        let {todos} = this.props
        // 总条数
        let total = todos.length;
        // 已完成数量
        let doneNum = todos.reduce((pre,item)=>{
            // 使用强制类型转换
            return pre + item.isDone
        },0)
        return(
            <div className="todo-footer">
                <label>
                    <input type="checkbox" />
                </label>
                <span>
                    <span>已完成 {doneNum}</span> / 全部 {total}
                </span>
                <button className="btn btn-danger">清除已完成任务</button>
            </div>
        )
    }
}
```

## 添加任务

```jsx
思路:
文本框输入内容，按下回车，将内容添加到列表中
1. 拆分步骤：
   1. 获取文本框输入内容
   2. 按下回车
   3. 将内容添加到列表中
2. 给步骤匹配你能想到的技术点
   1. 获取文本框输入内容
      1. ref
      2. 受控组件
      3. e.target.value
   2. 按下回车
      1. 绑定事件-键盘事件 keyup keydown  onKeyUp  onKeyDown
   3. 将内容添加到列表中
      子传父(通过调用父亲自身的方法[this.props]，传递参数从而修改父亲中的数据状态)
```

src->components->TodoList->TodoList.jsx

```jsx
import React, { Component } from 'react'
import {nanoid} from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default class TodoList extends Component {
    state={
        todos:[
            {
                id:nanoid(),
                title:'吸烟',
                isDone:true
            },
            {
                id: nanoid(),
                title: '喝酒',
                isDone: true
            },
            {
                id: nanoid(),
                title: '烫头',
                isDone: false
            }
        ]
    }
    addTodo(title){
        // 拼接一个新的todo
        let todo = {
            id:nanoid(),
            title,
            isDone:false
        }
        // 将todo加入到todos状态中
        this.setState({
            todos:[todo,...this.state.todos]
        })
    }
    render() {
        let { todos } = this.state
        return (
            <>
                <div className="todo-container">
                    <div className="todo-wrap">
                        <Header addTodo={this.addTodo.bind(this)}/>
                        <Main todos={todos}/>
                        <Footer todos={todos} />
                    </div>
                </div>
            </>
        )
    }
}
```

src->components->Header->Header.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Header extends Component {
    // 添加方法
    sendTitle(e){
        // 判断是否是回车键
        if(e.key !== 'Enter') return;
        const title = e.target.value.trim();
        this.props.addTodo(title)
        // 清空文本框
        e.target.value = ''
    }
    render() {
        return (
            <div className="todo-header">
                <input type="text" onKeyUp={(event) => this.sendTitle(event)} placeholder="请输入你的任务名称，按回车键确认" />
            </div>
        )
    }
}
```

## 删除任务

```jsx
描述：点击删除按钮，删除列表中的当前行
2. 步骤：
   1. 点击删除按钮
   2. 删除该行
3. 技术点：
   1. 点击删除按钮： onClick   传递 id
   2. 删除该行： 子传父
      数据在谁身上，方法就要定义在谁身上
```

src->components->Item->Item.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Item extends Component {
    render() {
        let {todo,deleteById} = this.props
        return (
            <li>
                <label>
                    <input type="checkbox" checked={todo.isDone} />
                    <span>{todo.title}</span>
                </label>
                <button className="btn btn-danger" onClick={()=>deleteById(todo.id)}>删除</button>
            </li>
        )
    }
}
```

src->components->Main->Main.jsx

```jsx
import React, { Component } from 'react'
import Item from '../Item/Item'
import './index.css'
export default class Main extends Component {
    render() {
        let {todos,deleteById} = this.props
        return (
            <ul className="todo-main">
                {todos.map(todo => (<Item key={todo.id} todo={todo} deleteById={deleteById} />))}
            </ul>
        )
    }
}
```

src->components->TodoList->TodoList.jsx

```jsx
import React, { Component } from 'react'
import {nanoid} from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default class TodoList extends Component {
    state={
        todos:[
            {
                id:nanoid(),
                title:'吸烟',
                isDone:true
            },
            {
                id: nanoid(),
                title: '喝酒',
                isDone: true
            },
            {
                id: nanoid(),
                title: '烫头',
                isDone: false
            }
        ]
    }
    addTodo(title){
        // 拼接一个新的todo
        let todo = {
            id:nanoid(),
            title,
            isDone:false
        }
        // 将todo加入到todos状态中
        this.setState({
            todos:[todo,...this.state.todos]
        })
    }
    deleteById(id) {
        if (!window.confirm('确定删除么?')) return;
        console.log('father id: ', id);
        // 
        this.setState({
            todos: this.state.todos.filter(todo => todo.id !== id)
        })
    }
    render() {
        let { todos } = this.state
        return (
            <>
                <div className="todo-container">
                    <div className="todo-wrap">
                        <Header addTodo={this.addTodo.bind(this)}/>
                        <Main todos={todos} deleteById={this.deleteById.bind(this)} />
                        <Footer todos={todos} />
                    </div>
                </div>
            </>
        )
    }
}
```

## 勾选完成

```jsx
1. 点击复选框，改变完成状态
2. 步骤：
   1. 点击复选框[复选框发生变化，触发一个事件]
   2. 改变该条的完成状态
3. 技术：
   1. 点击复选框[复选框发生变化，触发一个事件]   onChange 不是onClick事件
   2. 改变该条的完成状态， 子传父
```

src->components->Item->Item.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Item extends Component {
    render() {
        let { todo, deleteById, checkOne } = this.props
        return (
            <li>
                <label>
                    <input type="checkbox" checked={todo.isDone} onChange={() => checkOne(todo.id)}/>
                    <span>{todo.title}</span>
                </label>
                <button className="btn btn-danger" onClick={()=>deleteById(todo.id)}>删除</button>
            </li>
        )
    }
}
```

src->components->Main->Item.jsx

```jsx
import React, { Component } from 'react'
import Item from '../Item/Item'
import './index.css'
export default class Main extends Component {
    render() {
        let { todos, deleteById, checkOne } = this.props
        return (
            <ul className="todo-main">
                {todos.map(todo => (<Item key={todo.id} todo={todo} deleteById={deleteById} checkOne={checkOne} />))}
            </ul>
        )
    }
}
```

src->components->todoList->Item.jsx

```jsx
import React, { Component } from 'react'
import {nanoid} from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default class TodoList extends Component {
    state={
        todos:[
            {
                id:nanoid(),
                title:'吸烟',
                isDone:true
            },
            {
                id: nanoid(),
                title: '喝酒',
                isDone: true
            },
            {
                id: nanoid(),
                title: '烫头',
                isDone: false
            }
        ]
    }
    addTodo(title){
        // 拼接一个新的todo
        let todo = {
            id:nanoid(),
            title,
            isDone:false
        }
        // 将todo加入到todos状态中
        this.setState({
            todos:[todo,...this.state.todos]
        })
    }
    deleteById(id) {
        if (!window.confirm('确定删除么?')) return;
        console.log('father id: ', id);
        // 
        this.setState({
            todos: this.state.todos.filter(todo => todo.id !== id)
        })
    }
    checkOne(id){
        this.setState({
            todos: this.state.todos.map(todo => {
                if (todo.id === id) {
                    todo.isDone = !todo.isDone;
                }
                return todo;
            })
        })
    }
    checkAll(isDone){
        this.setState({
            todos:this.state.todos.map(todo=>{
                todo.isDone = isDone
                return todo
            })
        })
    }
    render() {
        let { todos } = this.state
        return (
            <>
                <div className="todo-container">
                    <div className="todo-wrap">
                        <Header addTodo={this.addTodo.bind(this)}/>
                        <Main todos={todos} deleteById={this.deleteById.bind(this)} checkOne={(id)=>this.checkOne(id)} />
                        <Footer todos={todos} checkAll={this.checkAll.bind(this)}/>
                    </div>
                </div>
            </>
        )
    }
}
```

src->components->Footer->Footer.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Footer extends Component {
    // changeToAll
    changeToAll(e) {
        const isChecked = e.target.checked
        this.props.checkAll(isChecked)
    }

    render(){
        // 接收todos
        let {todos} = this.props
        // 总条数
        let total = todos.length;
        // 已完成数量
        let doneNum = todos.reduce((pre,item)=>{
            // 使用强制类型转换
            return pre + item.isDone
        },0)
        return(
            <div className="todo-footer">
                <label>
                    <input type="checkbox" checked={doneNum === total && total > 0} onChange={this.changeToAll.bind(this)}/>
                </label>
                <span>
                    <span>已完成 {doneNum}</span> / 全部 {total}
                </span>
                <button className="btn btn-danger">清除已完成任务</button>
            </div>
        )
    }
}
```

## 删除已完成

src->components->todoList->todoList.jsx

```shell
添加一个方法：把isDone的todo过滤调
然后把这个方法传给子组件
```

```
    deleteDone(){
        if (!window.confirm('确定删除已完成么?')) return;
        this.setState({
            todos: this.state.todos.filter(todo => !todo.isDone)
        })
    }
    
    render() {
        let { todos } = this.state
        return (
            <>
    			<Footer deleteDone={this.deleteDone.bind(this)} />
            </>
        )
    }
```

src->components->Footer->Footer.jsx

```shell
子组件接收，然后调用方法
```

```shell
import React, { Component } from 'react'
import './index.css'
export default class Footer extends Component {
    // changeToAll
    changeToAll(e) {
        const isChecked = e.target.checked
        this.props.checkAll(isChecked)
    }

    render(){
        // 接收todos
        let { todos, deleteDone } = this.props
        // 总条数
        let total = todos.length;
        // 已完成数量
        let doneNum = todos.reduce((pre,item)=>{
            // 使用强制类型转换
            return pre + item.isDone
        },0)
        return(
            <div className="todo-footer">
                <label>
                    <input type="checkbox" checked={doneNum === total && total > 0} onChange={this.changeToAll.bind(this)}/>
                </label>
                <span>
                    <span>已完成 {doneNum}</span> / 全部 {total}
                </span>
                <button className="btn btn-danger" onClick={deleteDone}>清除已完成任务</button>
            </div>
        )
    }
}
```

## 本地缓存(完结)

```jsx
1. 存储：localStorage.setItem(key,value)
2. 读数据: localStorage.getItem(key)
3. 删除: localStorage.removeItem(key)
4. 全部删除: localStorage.clear()
```

src->components->todoList->todoList.jsx

```jsx
import React, { Component } from 'react'
import {nanoid} from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default class TodoList extends Component {
    state={
        // 初始数据为一个空数组
        todos:[]
    }
    // 组件挂载完成后
    componentDidMount(){
        // 从本地存储读取数据
        const stringTodos = localStorage.getItem('todos')
        // json字符串转为对象
        const objToDos = JSON.parse(stringTodos) || []
        // 设置数据状态
        this.setState({
            todos: objToDos
        })
    }
    // 当组件更新时
    componentDidUpdate(){
        // 把todos对象转为json字符串
        const stringTodos = JSON.stringify(this.state.todos)
        // 存储数据到localstorage
        localStorage.setItem('todos', stringTodos)
    }
    addTodo(title){
        // 拼接一个新的todo
        let todo = {
            id:nanoid(),
            title,
            isDone:false
        }
        // 将todo加入到todos状态中
        this.setState({
            todos:[todo,...this.state.todos]
        })
    }
    deleteById(id) {
        if (!window.confirm('确定删除么?')) return;
        console.log('father id: ', id);
        // 
        this.setState({
            todos: this.state.todos.filter(todo => todo.id !== id)
        })
    }
    checkOne(id){
        this.setState({
            todos: this.state.todos.map(todo => {
                if (todo.id === id) {
                    todo.isDone = !todo.isDone;
                }
                return todo;
            })
        })
    }
    checkAll(isDone){
        this.setState({
            todos:this.state.todos.map(todo=>{
                todo.isDone = isDone
                return todo
            })
        })
    }
    deleteDone(){
        if (!window.confirm('确定删除已完成么?')) return;
        this.setState({
            todos: this.state.todos.filter(todo => !todo.isDone)
        })
    }
    render() {
        let { todos } = this.state
        return (
            <>
                <div className="todo-container">
                    <div className="todo-wrap">
                        <Header addTodo={this.addTodo.bind(this)}/>
                        <Main todos={todos} deleteById={this.deleteById.bind(this)} checkOne={(id)=>this.checkOne(id)} />
                        <Footer todos={todos} checkAll={this.checkAll.bind(this)} deleteDone={this.deleteDone.bind(this)} />
                    </div>
                </div>
            </>
        )
    }
}
```

src->components->Main->Main.jsx

```jsx
import React, { Component } from 'react'
import Item from '../Item/Item'
import './index.css'
export default class Main extends Component {
    render() {
        let { todos, deleteById, checkOne } = this.props
        return (
            <ul className="todo-main">
                {todos.map(todo => (<Item key={todo.id} todo={todo} deleteById={deleteById} checkOne={checkOne} />))}
            </ul>
        )
    }
}
```

src->components->Header->Header.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Header extends Component {
    // 添加方法
    sendTitle(e){
        // 判断是否是回车键
        if(e.key !== 'Enter') return;
        const title = e.target.value.trim();
        this.props.addTodo(title)
        // 清空文本框
        e.target.value = ''
    }
    render() {
        return (
            <div className="todo-header">
                <input type="text" onKeyUp={(event) => this.sendTitle(event)} placeholder="请输入你的任务名称，按回车键确认" />
            </div>
        )
    }
}
```

src->components->Footer->Footer.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Footer extends Component {
    // changeToAll
    changeToAll(e) {
        const isChecked = e.target.checked
        this.props.checkAll(isChecked)
    }

    render(){
        // 接收todos
        let { todos, deleteDone } = this.props
        // 总条数
        let total = todos.length;
        // 已完成数量
        let doneNum = todos.reduce((pre,item)=>{
            // 使用强制类型转换
            return pre + item.isDone
        },0)
        return(
            <div className="todo-footer">
                <label>
                    <input type="checkbox" checked={doneNum === total && total > 0} onChange={this.changeToAll.bind(this)}/>
                </label>
                <span>
                    <span>已完成 {doneNum}</span> / 全部 {total}
                </span>
                <button className="btn btn-danger" onClick={deleteDone}>清除已完成任务</button>
            </div>
        )
    }
}
```

src->components->Item->Item.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default class Item extends Component {
    render() {
        let { todo, deleteById, checkOne } = this.props
        return (
            <li>
                <label>
                    <input type="checkbox" checked={todo.isDone} onChange={() => checkOne(todo.id)}/>
                    <span>{todo.title}</span>
                </label>
                <button className="btn btn-danger" onClick={()=>deleteById(todo.id)}>删除</button>
            </li>
        )
    }
}
```

# TodoList函数组件实现

**入口文件**：src->index.js

```js
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
// 导入重置样式表
import './index.css'
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
    <App />
);

```

**样式重置文件**：src->index.css

```css
/*base*/
body {
    background: #fff;
}

.btn {
    display: inline-block;
    padding: 4px 12px;
    margin-bottom: 0;
    font-size: 14px;
    line-height: 20px;
    text-align: center;
    vertical-align: middle;
    cursor: pointer;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);
    border-radius: 4px;
}

.btn-danger {
    color: #fff;
    background-color: #da4f49;
    border: 1px solid #bd362f;
}

.btn-danger:hover {
    color: #fff;
    background-color: #bd362f;
}

.btn:focus {
    outline: none;
}
```

**App主组件**：src->App.jsx

```jsx
import React from 'react'
import TodoList from './components/TodoList/TodoList'

export default function App(){
    return(
        <div>
            <TodoList/>
        </div>
    )
}
```

**TodoList子组件**：src->components->TodoList->TodoList.jsx

```jsx
import React, { useEffect, useRef, useState } from 'react'
import { nanoid } from 'nanoid'
import Footer from '../Footer/Footer'
import Header from '../Header/Header'
import Main from '../Main/Main'
import './index.css'

export default function TodoList(){
    // 定义标记Ref,设置初始值为true
    const flagRef = useRef(true)
    // 状态数据定义
    let [todos,setTodos] = useState([])
    // 添加todo
    function addTodo(mission){
        // 创建一个对象
        let todo = {
            id: nanoid(),
            mission,
            isDone: false
        }
        // 把这对象添加到数组中:使用setTodos,把新值赋值给旧值替换
        setTodos([todo,...todos])
    }
    // 删除todo
    function delTodo(id){
        if (!window.confirm('确定要删除么?')) return;
        // 使用filter方法返回一个新数组,把剩下来的 赋值给Todos
        setTodos(todos.filter(todo=>id !== todo.id))
    }

    // 修改checked状态
    function checkOne(id){
        setTodos(todos.map(todo=>{
            if (todo.id === id){
                todo.isDone = !todo.isDone
            }
            return todo
        } ))
    }

    // 全选状态
    function checkAll(isDone){
        setTodos(todos.map(todo=>{
            todo.isDone = isDone
            return todo
        }))
    }

    // 清除已完成
    // 将isDone是true删掉 == > 将isDone是false的保留
    function delDoneMission(){
        if (!window.confirm('确定要删除完成的项目么?')) return
        setTodos(todos.filter(todo=>!todo.isDone))
    }

    // 组件挂载完成后执行
    useEffect(()=>{
        // componentDisMount,挂载完成后从localStorage中获取数据
        let todosJson = localStorage.getItem('todos')
        let todos = JSON.parse(todosJson) || []
        // 设置todos
        setTodos(todos)
    },[])
    // 组件更新完成后执行
    useEffect(()=>{
        if (flagRef.current){
            flagRef.current = false
            return
        }
        // 更新本地存储数据
        localStorage.setItem('todos',JSON.stringify(todos))
    },[todos])

    return(
        <>
            <div className="todo-container">
                <div className="todo-wrap">
                    <Header addTodo={addTodo}/>
                    <Main todos={todos} delTodo={delTodo} checkOne={checkOne} />
                    <Footer todos={todos} delDoneMission={delDoneMission} checkAll={checkAll}/>
                </div>
            </div>
        </>
    )
}
```

**Main子组件**：src->components->Main->Main.jsx

```jsx
import React from 'react'
import Item from '../Item/Item'
import './index.css'
export default function Main({ todos, delTodo,checkOne }){
    return(
        <ul className="todo-main">
            {todos.map(todo => (
                <Item key={todo.id} todo={todo} delTodo={delTodo} checkOne={checkOne} />
            ))}
        </ul>
    )
}
```

**Item子组件**：src->components->Item->Item.jsx

```jsx
import React from 'react'
import './index.css'
export default function Item({ todo, delTodo,checkOne }){

    return (
        <li>
            <label>
                <input type="checkbox" checked={todo.isDone} onChange={()=>checkOne(todo.id)}/>
                <span>{todo.mission}</span>
            </label>
            <button className="btn btn-danger" onClick={()=>{delTodo(todo.id)}}>删除</button>
        </li>
    )
}
```

**Header子组件**：src->components->Header->Header.jsx

```jsx
import React from 'react'
import './index.css'
export default function Header ({addTodo}){
    function addMission(e){
        // 1. 判断是否按的是回车
        // 2. 获取用户输入内容
        // 3. 调用方法，传递数据给父组件
        if(e.key !== 'Enter') return;
        let mission = e.target.value.trim()
        addTodo(mission)
        // 清空文本框
        e.target.value = ''
    }
    return (
        <div className="todo-header">
            <input type="text" onKeyUp={addMission} placeholder="请输入你的任务名称，按回车键确认" />
        </div>
    )
}
```

**Footer子组件**：src->components->Footer->Footer.jsx

```jsx
import React, { Component } from 'react'
import './index.css'
export default function Footer({todos,delDoneMission,checkAll}){
    let total = todos.length;
    let doneNum = todos.reduce((pre,item)=>{return pre + item.isDone},0)
    return (
        <div className="todo-footer">
            <label>
                <input type="checkbox" checked={doneNum === total && total > 0} onChange={(e)=>checkAll(e.target.checked)} />
            </label>
            <span>
                <span>已完成{doneNum}</span> / 全部{total}
            </span>
            <button className="btn btn-danger" onClick={delDoneMission}>清除已完成任务</button>
        </div>
    )
}
```

