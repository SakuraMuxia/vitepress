# 正则表达式

## 正则表达式概述

```json
1. 什么是正则表达式
   正则表达式用于对字符串进行匹配、检索、替换，是对字符串执行模式匹配的强大工具。
   
2. 正则表达式的应用
   1. 对用户输入进行验证匹配
   2. 从爬虫程序爬取的数据中获取有效信息
   3. 关键词、敏感词的替换、删除

3. 如何学习正则表达式
   3.1 如何写正则表达式
   3.2 编程语法如何用正则表达式
```

## 正则表达式的作用

```js
验证用户名、邮箱、电话号码、邮编等是否正确
进行字符串替换
富文本编辑器
爬虫程序、内容采集器
```

## 正则表达式基本语法

### 原子

**字符串由字符组成，正则表达式由原子组成。**  **正则中的一个原子能匹配字符串中的一个字符！**

```js
原子的表示 \\
字符串的表示 ""
```



#### ①原子直接量

正则表达式中，一个字母、一个数字、一个汉字、一个符号都是一个原子

**具有特殊含义的符号，需要使用反斜杠转义**	

```js
原子直接量的表示 //
原子函数的表示 new RegExp()
字符串直接量的表示 ""
```

| 原子（元字符） | 描述                                        |
| -------------- | ------------------------------------------- |
| `\n`           | 查找换行符。                                |
| `\f`           | 查找换页符。                                |
| `\r`           | 查找回车符。                                |
| `\t`           | 查找制表符。                                |
| `\v`           | 查找垂直制表符。                            |
| `\uxxxx`       | 查找以十六进制数 xxxx 规定的 Unicode 字符。 |

#### ②字符类

一直`[]`就是一个原子。一个原子匹配字符串中的一个字符。

| 元字符   | 描述                                                         |
| :------- | :----------------------------------------------------------- |
| `[abc]`  | 匹配方括号之间的任何字符 例 `[abc]`、`[a-z]`、`[b-f0-9]`、`[a-z0-9_]` |
| `[^abc]` | 查找任何不在方括号之间的字符。                               |
| `.`      | 匹配除了换行和行结束符外所有的字符。 `[^\n]`                 |
| `\w`     | 匹配数字、字母或下划线 `[a-zA-Z0-9_]`                        |
| `\W`     | 匹配除了数字、字母或下划线以外的字符 `[^a-zA-Z0-9_]`         |
| `\d`     | 匹配数字字符 `[0-9]`                                         |
| `\D`     | 匹配非数字字符 `[^0-9]`                                      |
| `\s`     | 匹配空白字符 `[\n\t\v\r\f]`                                  |
| `\S`     | 匹配空白字符以外的其他字符 `[^\n\t\v\r\f]`                   |

```js
[0-9]    查找任何从 0 至 9 的数字。
[a-z]    查找任何从小写 a 到小写 z 的字符。
[A-Z]    查找任何从大写 A 到大写 Z 的字符。
[A-z]    查找任何从大写 A 到小写 z 的字符。
[adgk]    查找给定集合内的任何字符。
[^adgk]    查找给定集合外的任何字符。

字符类（一个原子可以匹配到的字符的范围较广） 
[a-z]		匹配所有的小写字母
[b-g]		匹配b、c、d、e、f、g 字母
[a-zA-Z]		匹配所有的大小写字母
[a-zA-Z0-9_] 匹配大小写字母、数字、下划线
[^0-9]		匹配除了数字外所有的字符
[小乐_9b]	   匹配 小、乐、_、9、b 任意一个
[^小乐_9b]	   匹配除了小、乐、_、9、b

\d			相当于 [0-9]
\D			相当于 [^0-9]
\w			相当于 [a-zA-Z0-9_]
\W			相当于 [^a-zA-Z0-9_]

案例1
[小乐Hh14]
一个原子匹配一类字符，该原子可以匹配一个字符，字符可以是 小、乐、H、h、1、4
案例2
[^小乐Hh14]
该原子可以匹配一个字符, 字符是除了小、乐、H、h、1、4以外的其他
案例3
[0-9]
匹配连续的数字、字母
```

#### ③特殊字符

如果要匹配的字符是在正则中具有特殊意义的符号，可以使用反斜杠`\`来转义；

例如：`\.` 匹配字符串`.`

```js
 . 可以匹配任意字符
```

### 数量修饰符

**数量修饰符写在原子的后面，对前面的原子进行数量修饰。**

```js
{n}		前面的原子连续出现n次
{n,m}	前面的原子连续出现n到m次
{n,}    前面的原子连续出现n次及以上

?		相当于 {0,1}
+		相当于 {1,}
*		相当于 {0,}
```

> 正则表达式会尽可能多的匹配，称为贪婪匹配。

| 模式    | 描述                                            |
| ------- | ----------------------------------------------- |
| `{n}`   | 前面原子的数量 n次                              |
| `{n,}`  | 前面原子的数量n次以及以上                       |
| `{n,m}` | 前面原子的数量n次到m次                          |
| `?`     | 前面原子的数量 0次或 1次 `{0,1}`                |
| `+`     | 前面原子的数量1次或多次 `{1,}`                  |
| `*`     | 前面原子的数量0次、1次或多次也就是任意次 `{0,}` |

> 默认会尽可能多的匹配，故称之为**贪婪匹配。**
>
> 正则表达式后面加`?`可以阻止贪婪匹配。

### 位置修饰符

```js
^	表示字符串起始
$	表示字符串结尾
```

| 模式 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| `\b` | 匹配一个单词边界，也就是指单词和空格间的位置。例如， `er\b` 可以匹配"never" 中的 'er'，但不能匹配 "verb" 中的 'er' |
| `\B` | 匹配非单词边界。`er\B` 能匹配 "verb" 中的 'er'，但不能匹配 "never" 中的 'er' |
| `\A` | 匹配字符串开始                                               |
| `\Z` | 匹配字符串结束，如果是存在换行，只匹配到换行前的结束字符串   |
| `^`  | 匹配字符串的开头 同`\A`                                      |
| `$`  | 匹配字符串结束 同`\Z`                                        |

### 模式单元

```js
()		将多个原子作为一个整体
```

### 模式修饰符

模式修饰符对整个正则表达式进行修饰：

```js
i		不区分大小写
g		全局匹配
m		多行模式， 多行模式每一行被当做单独的字符串，^ 和 $ 可以匹配每行的开始结束
```

```js
使用方法
/正则/模式修饰符

console.log(/Hello/.test('hello'));
console.log(/Hello/i.test('hello'));
console.log(/Hello/i.test('HELLO'));
console.log('');


var msg = 'scholl\nhello\n52323';
console.log(msg);

console.log(/^hello$/.test(msg));
console.log(/^hello$/m.test(msg));
```

#### 什么是模式单元

```python
/(\w{3})/
```

括号里的部分就构成了一个模式单元。

#### 模式单元的作用

- 改变优先级。
- 将多个原子视为一个原子。
- **暂存内存** 将匹配的内容捕获暂存在内存，`/(?:abc)/` 用问号冒号，可以取消暂存内存的特性。
- **反向引用** 可以将模式单元的内容反向引用。使用`$1`、`$2`可以反向引用， `$1`会引用第一个模式单元匹配的内容。

```js
// 从字符串中提取 以a开头的单词
var reg = /[aA]([a-zA-Z]+)/g;

console.log(msg.match(reg));//输出的对象中，不仅包括匹配的数组，还包括模式单元中的内容(括号内)
console.log(reg.exec(msg));//输出的对象中，不仅包括匹配的数组，还包括模式单元中的内容(括号内)
```



#### groups 捕获组

```js
// 命名捕获组的获取
let reg = /(?<first>\d)(?<second>\d)/
let str = '123'

console.log(reg.exec(str).groups) 
// => { first: 1, second: 2 } 新的语法支持对这些捕获组进行命名，更方便地获取某个捕获组的数据
```

### 选择修饰符

`|` 修饰符类似于逻辑或

```js
a|b         // 匹配a或者b                        
abc|def     // 匹配abc  或者def  字符串的结合优先级高于选择    
ab(c|d)ef   // 匹配abcef   或者abdef
```

案例

```js
// 验证邮箱的正则
/*
xiaole@163.com
xiaole@sina.com.cn
xiao-le@foxmail.com
xiao_le@foxmail.com
xiao12@foxmail.com
13123123@foxmail.com
*/
var email_reg = /^[\w-]+@\w+(\.\w+){1,2}$/;
```



## JavaScript 中使用正则表达式

### RegExp 对象

#### ① 如何创建RegExp 对象

```js
// 创建 RegExp 对象，第一种方式：直接量方式；
/^[\w-]+@[\w-]+(\.\w+){1,2}$/;

// 创建 RegExp 对象，第二种方式：RegExp函数；
RegExp('^1[3-9]\d{9}$');

// 创建 RegExp 对象，第三种方式：RegExp构造函数；
new RegExp('[1-9]\d{4,10}');

```

#### ②RegExp 对象的方法

```js
test()			参数是字符串（字符串中只要包含一个原子即可 true），返回布尔值，适合验证
exec()			参数是字符串，匹配成功返回数组，匹配不成功返回null	，适合提取	
```

### String 对象

```js
search()		参数是正则表达式，返回字符串中第一个满足正则的部分的索引，无法匹配返回 -1
match()			参数是正则表达式，匹配成功返回数组，无法匹配返回 null
replace()		进行替换，第一个参数是正则表达式；默认只替换一个，替换所有需要进行全局匹配 
例如	replace(/6/g,"六") 全局把6替换成六
split()			将字符串分割为数组，可以使用正则指定分割符号
例如：string.split(/[\.,;]/)，[]单个原子，"，。；"都可以作为分割符号
```



## 常用正则表达式

```js
一、校验数字的表达式
数字：^[0-9]*$
n位的数字：^\d{n}$
至少n位的数字：^\d{n,}$
m-n位的数字：^\d{m,n}$
零和非零开头的数字：^(0|[1-9][0-9]*)$
非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]{1,2})?$
带1-2位小数的正数或负数：^(\-)?\d+(\.\d{1,2})?$
正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$
有两位小数的正实数：^[0-9]+(.[0-9]{2})?$
有1~3位小数的正实数：^[0-9]+(.[0-9]{1,3})?$
非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^\+?[1-9][0-9]*$
非零的负整数：^\-[1-9][]0-9"*$ 或 ^-[1-9]\d*$
非负整数：^\d+$ 或 ^[1-9]\d*|0$
非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$

二、校验字符的表达式
汉字：^[\u4e00-\u9fa5]{0,}$
英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$
长度为3-20的所有字符：^.{3,20}$
由26个英文字母组成的字符串：^[A-Za-z]+$
由26个大写英文字母组成的字符串：^[A-Z]+$
由26个小写英文字母组成的字符串：^[a-z]+$
由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$
由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w{3,20}$
中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$
中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$
可以输入含有^%&',;=?$\"等字符：[^%&',;=?$\x22]+
禁止输入含有~的字符：[^~\x22]+

三、特殊需求表达式
Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
域名：[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.?
InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&=]*)?$
手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$
电话号码("XXX-XXXXXXX"、"XXXX-XXXXXXXX"、"XXX-XXXXXXX"、"XXX-XXXXXXXX"、"XXXXXXX"和"XXXXXXXX)：^(\(\d{3,4}-)|\d{3.4}-)?\d{7,8}$ 
国内电话号码(0511-4405222、021-87888822)：\d{3}-\d{8}|\d{4}-\d{7}
身份证号：
15或18位身份证：^\d{15}|\d{18}$
15位身份证：^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$
18位身份证：^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{4}$
短身份证号码(数字、字母x结尾)：^([0-9]){7,18}(x|X)?$ 或 ^\d{8,18}|[0-9x]{8,18}|[0-9X]{8,18}?$
帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$
密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w{5,17}$
强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$ 
日期格式：^\d{4}-\d{1,2}-\d{1,2}
一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$
一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$ 
中文字符的正则表达式：[\u4e00-\u9fa5]
空白行的正则表达式：\n\s*\r (可以用来删除空白行)
HTML标记的正则表达式：<(\S*?)[^>]*>.*?</\1>|<.*? /> (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)
首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)
腾讯QQ号：[1-9][0-9]{4,} (腾讯QQ号从10000开始)
中国邮政编码：[1-9]\d{5}(?!\d) (中国邮政编码为6位数字)
IP地址：\d+\.\d+\.\d+\.\d+ (提取IP地址时有用)
```

